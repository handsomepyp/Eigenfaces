# Face Recognition Using Eigenfaces(使用特征脸的人脸识别)

> 麻省理工学院
>
> 媒体实验室与视觉建模小组
>
> Matthew A. Turk and Alex P. Pentland

## Abstract

> 我们提出了一种检测和识别人脸的方法，并描述了一种工作的近实时人脸识别系统，该系统可以跟踪对象的头部，然后通过将脸部特征与已知个体的特征进行比较来识别人。我们的方法利用人脸通常是直立的事实来将人脸识别视为二维识别问题，因此可以通过少量的二维特征视图来描述。面部图像被投影到特征空间（“面部空间”）上，该特征空间最好地编码已知面部图像之间的变化。 脸部空间由“特征脸”定义，“特征脸”是脸部集合的特征向量，它们不一定对应于孤立的特征，例如眼睛，耳朵和鼻子。 该框架提供了以无人监督的方式学习识别新面孔的能力。

## 1 Introduction

> 它们是自然的一类物体，与正弦波光栅，“块状世界”以及人类和计算机视觉研究中使用的其他人工刺激形成鲜明对比[1]。 因此，与大多数早期的视觉功能不同，我们可以针对这些功能构建详细的视网膜或纹状体活动模型，而人脸识别是一项非常高级的任务，其计算方法目前只能建议对相应神经活动的广泛限制。
>
> 因此，我们将研究重点放在开发一种不依赖完整的三维模型或详细几何图形的早期，前瞻性的模式识别能力。我们的目标是开发一种快速，合理地简单且人性化的人脸识别计算模型。 在办公室或家庭等受限制的环境中准确显示。
>
> 尽管人脸识别是一个高级视觉问题，但任务上还是有很多结构。 我们通过提出一种基于[**信息论方法**](https://zh.wikipedia.org/wiki/%E4%BF%A1%E6%81%AF%E8%AE%BA)的识别方案来利用这种结构中的某些结构，该方法旨在在一组人脸中编码最相关的信息，从而最好地将它们彼此区分开。 该方法将面部图像转换为一小组称为“特征脸”的特征图像，这是面部图像初始训练集的主要组成部分。 通过将新图像投影到特征脸 （“脸部空间”）所跨越的子空间中，然后通过将脸部在脸部空间中的位置与已知个体的位置进行比较来对脸部进行分类，从而进行识别。
>
> 在此框架内，自动学习并稍后识别新面孔是可行的。 通过在有限数量的特征视图（例如“直视”视图，45°视图和纵断面视图）上进行训练，可以在合理变化的条件下进行识别。 该方法在速度和简单性，学习能力以及对人脸图像中较小或逐渐变化的相对不敏感方面，比其他人脸识别方案具有优势。

### 1.1 Background and related work

> 计算机识别人脸的大部分工作都集中在检测各个特征，例如眼睛，鼻子，嘴巴和头部轮廓，并通过位置，大小以及这些特征之间的关系来定义人脸模型。 从Bledsoe [2]和Kanade [3]的早期系统开始，许多自动或半自动人脸识别策略已基于归一化的距离和特征点之间的比率对人脸进行建模和分类。 最近，Yuille等人[4]的最新工作继续并改进了这种通用方法。
>
> 事实证明，这样的方法很难扩展到多种观点，并且通常非常脆弱。 此外，对人脸识别策略的研究表明，个人特征及其直接关系不足以代表成人人脸识别的性能[5]。 尽管如此，这种面部识别方法仍然是计算机视觉文献中最受欢迎的方法。
>
> 面对面识别的连接主义者方法试图捕获任务的构型或**[格式塔](https://zh.wikipedia.org/wiki/%E6%A0%BC%E5%BC%8F%E5%A1%94%E5%AD%A6%E6%B4%BE)**性质。 在Kohonen和Lahtio [7]的早期工作的基础上，Fleming和Cottrell [6]使用非线性单元通过反向传播对网络进行训练，以对面部图像进行分类。 Stonham的WISARD系统[8]已成功应用于二值人脸图像，能够识别身份和表情。 大多数处理人脸的连接系统将输入图像视为普通的2D模式，并且不能明确使用人脸的配置属性。 迄今为止，仅探索了非常简单的系统，目前尚不清楚它们将如何扩展到更大的问题。
>
> Burt等人的最新工作。 使用基于多分辨率模板匹配的“智能感知”方法[9]。 这种从粗到精的策略使用专用计算机来快速计算多分辨率金字塔图像，并且已被证明可以近乎实时地识别人。 面部模型是根据面部图像手动构建的。

## 2.Eigenfaces for Recognition (识别特征脸)

> 假设预先定义的测量是相关且足够的，那么以前有关自动面部识别的许多工作都忽略了面部刺激的那些方面对于识别很重要的问题。 这向我们表明，编码和解码人脸图像的信息论方法可以深入了解人脸图像的信息内容，强调重要的局部和全局“特征”。 这些特征可能与我们对诸如眼睛，鼻子，嘴唇和头发的面部特征的直观概念没有直接关系。
>
> 在信息论的语言中，我们要提取人脸图像中的相关信息，并对其进行尽可能有效的编码，然后将一个人脸编码与相似编码的模型数据库进行比较。 提取面部图像中包含的信息的一种简单方法是，以某种方式捕获面部图像集合中的变化，而与特征的任何判断无关，并使用此信息来编码和比较各个面部图像。
>
> 用数学术语来说，我们希望找到人脸分布的主要成分，或人脸图像集协方差矩阵的特征向量。 这些特征向量可以被认为是一起表征面部图像之间的变化的一组特征。 每个图像位置或多或少地影响了每个特征向量，因此我们可以将特征向量显示为一种鬼脸，称为特征脸。 其中一些面孔如图2所示。
>
> 图2
>
> 训练集中的每个人脸图像都可以根据特征人脸的线性组合准确表示。 可能的特征脸的数量等于训练集中的脸部图像的数量。 但是，也可以仅使用“最佳”特征脸（具有最大特征值的那些特征脸）来对它们进行近似，因此，它们在脸部图像集中占最大差异。 使用较少特征脸的主要原因是计算效率。 最好的M'特征脸跨越所有可能图像的M'维子空间（“脸部空间”）。 由于频率和相位变化的正弦曲线是傅立叶分解的基础函数（实际上是线性系统的本征函数），因此特征脸是本征面分解的基础向量。
>
> 使用本征脸的想法是由Sirovich和Kirby [10]开发的一种技术激发的，该技术使用主成分分析来有效地表示脸部图片。 他们认为，通过为每张脸存储少量的权重和少量的标准图片，可以大致重建脸部图像的集合。
>
> 我们想到，如果可以通过少量特征图像集合的加权和重建大量的面部图像，那么学习和识别面部的有效方法可能是从已知的面部图像中构建特征并识别特定的面部通过比较（近似）重构特征权重所需的特征权重和与已知个体相关的权重。
>
> 以下步骤概述了识别过程：
>
> > 1.初始化：获取训练的人脸图像集并计算特征脸，以定义人脸空间。
> > 2.遇到新的人脸图像时，通过将输入图像投影到每个特征脸上，根据输入图像和特征脸计算一组权重。
> > 3.通过检查图像是否足够接近“面部空间”来确定图像是否是人脸（已知的还是未知的）。
> > 4.如果是面部，则将体重模式分类为已知人物或未知人物。
> > 5.(可选)如果多次看到同一张未知的面孔，请计算其特征体重模式并将其合并到已知的面孔中（即，学会识别它）。

### 2.1 Calculating Eigenfaces(计算特征脸)

> 令面部图像I(x,y)为强度值的二维N×N数组，或为维度 N<sup>2</sup>  的向量。 尺寸为256 x 256的典型图像描述了尺寸为65,536的向量，或者等效地，为65,536尺寸空间中的一个点。 然后，大量的图像映射到这个巨大空间中的一系列点。
>
> 总体结构相似的人脸图像不会在这个巨大的图像空间中随机分布，因此可以用相对低维的子空间来描述。 主成分分析（或Karhunen-Loeve展开）的主要思想是找到最能说明面部图像在整个图像空间中的分布的向量。 这些向量定义了人脸图像的子空间，我们称其为 "人脸空间"，每个向量的长度为N<sup>2</sup>，描述了一个N到N的图像，并且是原始人脸图像的线性组合，因为这些向量是人脸图像的特征向量协方差矩阵对应于原始人脸图像，并且由于它们的外观类似于人脸，因此我们将其称为“特征脸”。 特征脸的一些示例如图2所示。
>
> 让训练的面部图像集为Γ<sub>1</sub>,Γ<sub>2</sub>,Γ<sub>3</sub>,...Γ<sub>M</sub>。集合的平均脸由ψ = 1/M ∑<sub>n=1</sub><sup>M</sup>Γ<sub>n</sub>所定义，每张脸与向量 Φ<sub>i</sub> = Γ<sub>i</sub> - ψ的平均值不同。图1（a）中显示了一个示例训练集，图1（b）中显示了平均脸。然后，对这组非常大的向量进行主成分分析。 它寻找一组M个正交向量 u<sub>n</sub> 及其相关的特征值 λ<sub>k</sub>，以最好地描述数据的分布。 向量 u<sub>k</sub> 和标量 λ<sub>k</sub> 分别是特征向量和特征值。 协方差矩阵的
>
> ​									C = 1/M ∑<sub>n=1</sub><sup>M</sup>Φ<sub>n</sub> Φ<sub>n</sub><sup>T</sup>
>
> ​										= A A<sup>T</sup>
>
> A矩阵代表 A = [Φ<sub>1</sub> Φ<sub>2</sub> ...Φ<sub>M</sub>]。然而矩阵C，是N<sup>2</sup>×N<sup>2</sup>的，并且对于典型的图像尺寸而言，确定 N<sup>2</sup> 个特征向量和特征值是一项棘手的任务。 我们需要一个计算上可行的的方法来找到这些特征向量。幸运的是，我们可以通过以下方法确定特征向量：首先解决一个较小的M×M的矩阵问题，然后对所得向量进行线性组合(有关详细信息参见[11])。
>
> 图1
>
> 通过这种分析，计算量从图中的像素数量(N<sup>2</sup>)到训练组中的(M)图像数量被大大减少。实际上，面部图像的训练集将相对较小(M<<N<sup>2</sup>)，并且计算变得非常易于管理。关联的特征值使我们能够根据特征向量在表征图像变化中的有用性对其进行排名。图2显示了从图1的输入图像派生的前七个特征脸。通常，背景是通过裁减训练图像去除的。从而使特征脸在脸部区域之外具有0值。

### 2.2 Using Eigenfaces to classify a face image(使用特征脸对人脸图像进行分类)

> 一旦创建了特征脸，识别就成为模式识别的任务，特征脸跨越原始N<sup>2</sup> 图像空间的M<sup>'</sup> 维子空间。选择L矩阵的M'个有效特征向量作为具有最大相关特征值的特征向量。在我们的许多测试案例中，基于M = 16的面部图像，使用了M'= 7的特征脸。 基于特征值启发式地选择要使用的特征面的数量。
>
> 通过简单的计算ω<sub>k</sub> = u<sub>k</sub><sup>T</sup> (T - Ψ) (k = 1......M<sup>'</sup>)，新的人脸图像(Γ)被转换为其特征脸成分（投影到“脸部空间”中）。这描述了一组点对点图像的乘法和求和。图3显示了三张图像以及到七维脸部空间的投影。
>
> 图3
>
> 权重形成向量 Ω<sup>T</sup> = [ω<sub>1</sub> ω<sub>2</sub> ......ω<sub>M<sup>'</sup></sub>],该向量描述每个特征脸在表示输入面部图像中的贡献。将特征脸作为脸部图像的基础集。该向量用于查找多个预定义的面部类别中的哪一个（如果有的话）最能描述面部。确定哪个面部类别可提供对输入面部图像的最佳描述的最简单方法是找到使欧氏距离 ε<sub>k</sub> = || (Ω - Ω<sub>k</sub>) || 最小的面部类别 k，其中 Ω<sub>k</sub>是描述第k个面部类别的向量 。当最小 ε<sub>k</sub> 低于某个选定阈值 θ<sub>k</sub> 时，将脸部归为k类。否则，将脸部归为“未知”。

### 2.3 Using Eigenfaces to detect faces(使用特征脸检测面部)

> 我们还可以使用面部空间知识来检测和定位单个图像中的面部。 除了识别脸部的任务之外，这还使我们能够识别脸部的存在。
>
> 为图像创建权重向量等效于将图像投影到低维面部空间。图像与其在脸部空间上的投影距离ε 简化为调整后的输入头像在脸部空间的投影距离Φ = Γ - Ψ和Φ<sub>f</sub> = Σ<sub>i=1</sub><sup>i=M<sup>'</sup></sup>ω<sub>k</sub>u<sub>k</sub>  之和。
>
> 如图3所示，当投影到脸部空间时，脸部图像不会发生根本变化，而非脸部图像的投影看起来却完全不同。该基本思想用于检测场景中人脸的存在：在图像中的每个位置，计算局部子图像与人脸空间之间的距离ε ，距面部空间的距离用作“面部”的度量，因此计算图像中每个点距面部空间的距离的结果为“面部图”ε(x,y)。图4显示了一张图像及其脸部贴图-低值（深色区域）表示存在脸部。 人脸图中存在与图像中人脸位置相对应的明显最小值。
>
> 不幸的是，直接计算该距离度量非常昂贵。 因此，我们开发了一种更简单，更有效的计算人脸图 ε(x,y) 的方法，该方法在[11]中进行了描述。

### 2.4 Face space revisited(重访面部空间)

> 脸部的图像，尤其是训练集中的脸部图像，应位于脸部附近，脸部空间通常描述的是“类脸”图像。换句话说，投影距离 ε 应该在某个阈值  θ<sub>δ</sub>内。已知个体的图像应该投影到相应的面部类别附近，即 ε<sub>k</sub> < θ<sub>δ</sub> 内。因此，输入图像及其模式向量有四种可能性：（1）在脸部空间附近和脸部类别附近； （2）在脸部空间附近，但不在已知的脸部类别附近； （3）远离面部空间并靠近面部类别； （4）远离面部空间且不靠近已知的面部类别。 图5显示了两个特征脸的简单示例的这四个选项。
>
> 图5
>
> 在第一种情况下，将识别并识别一个人。 在第二种情况下，存在一个未知的人。 最后两种情况表明该图像不是面部图像。 案例三在大多数识别系统中通常显示为误报； 然而，在我们的框架中，由于图像与预期人脸图像的子空间之间的距离较大，因此可能会检测到错误识别。 图3显示了一些图像及其在面部空间中的投影。 图3（a）和（b）是情况1的示例，而图3（c）说明了情况4。
>
> 在我们当前的系统中，作为训练的一部分，特征脸的计算是离线完成的。 目前，使用大小为128x128的面部图像，在Sun Sparcstation 1上的Lisp中运行时，识别速度大约为350毫秒，效率相当低。

## 3.Recognition Experiments(识别实验)

> 为了评估这种人脸识别方法的可行性，我们对存储的人脸图像进行了实验，并建立了在动态环境中定位和识别人脸的系统。 我们首先创建了一个大型的人脸图像数据库，该人脸图像是在各种成像条件下收集的。 使用该数据库，我们进行了一些实验，以评估在已知的光照，比例和方向变化下的性能。
>
> 图1（a）中的图像取自在受控条件下数字化的2500多个面部图像的数据库。 在三个头部方向，三个头部大小或比例以及三个光照条件的所有组合下，对十六名受试者进行了数字化处理。 每个图像都构建了一个六级高斯金字塔，其图像分辨率从512x512像素降低到16x16像素。
>
> 在第一个实验中，变化照明的效果。 使用2500张图像的完整数据库调查了大小和头部方向。 选择各种组的十六个图像并将其用作训练集。 在每个训练集中，每个人都有一张图像，所有图像都是在相同的光照，图像大小和头部方向条件下拍摄的。 然后，数据库中的所有图像都被归类为这16个人之一-没有面孔被拒绝为未知对象。
>
> 收集统计数据，测量平均准确度作为训练条件与测试条件之间差异的函数。 在 θ<sub>δ</sub> 和 θ<sub>ε</sub>为无限的情况下，系统在照明变化上的平均分类正确率约为96％，在方向变化上的平均分类正确率约为85％，在尺寸变化上的平均正确分类率为64%。
>
> 在第二个实验中，遵循相同的步骤，但可接受阈值  θ<sub>ε</sub> 也有所变化。 在 θ<sub>ε</sub> 的低值下，仅会识别出与已知面部类别非常接近的图像（图5中的case1和3），因此几乎没有错误，但是许多图像将被拒绝为未知图像。 在 θ<sub>ε</sub> 为高值时，大多数图像将被分类，但是会有更多错误。 调整 θ<sub>ε</sub> 以实现100％的准确识别，可在改变照明的同时将未知率提高到19％，将方向提高到39％，将尺寸提高到60％。 将未知率任意设置为20％时，正确识别率分别为100％，94％和74％。
>
> 这些实验表明，随着接受阈值的降低，性能精度也会提高。 当阈值趋于零时，可以对其进行调整以实现有效的完美识别，但是会以许多图像被拒绝为未知数为代价。 对于各种面部识别应用程序中的每一个，拒绝率和识别精度之间的权衡都是不同的。
>
> 结果还表明，变化的照明条件导致相对较少的错误，而性能随着尺寸变化而急剧下降。 这不足为奇，因为仅在照明变化下，邻域像素相关性仍然很高，但是在尺寸变化下，从一个图像到另一个图像的相关性却很低。 显然，需要一种多尺度方法，以便将特定大小的面孔相互比较。

## 4.Real-time recoginition(实时识别)

> 人们在不断移动。 即使坐着，我们也会坐立不安并调整身体位置，眨眼，环顾四周等等。 对于在静态环境中移动的人，我们构建了一个简单的运动检测和跟踪系统，如图6所示，该系统可以定位并跟踪头部的位置。 简单的时空滤波和非线性会加重强度随时间变化的图像位置，因此移动的人会在滤波后的图像中“点亮”。
>
> 在对滤波后的图像进行阈值处理以生成二进制运动图像之后，我们随时间分析“运动斑点”，以确定运动是否是由人的移动引起的，并确定头部位置。 应用了一些简单的规则，例如“头部是较大的斑点（身体）上方的较小的上部斑点”，以及“头部运动必须相当缓慢且连续”（不要期望头部不规则地围绕图像跳跃 ）。 图7显示了在前面的帧序列中定位了头部的图像以及头部的路径。
>
> 我们已经使用上述技术来构建一个系统，该系统可以在合理的非结构化环境中近乎实时地定位和识别人脸。 当运动检测和分析程序找到头部时，以头部为中心的子图像将发送到面部识别模块。 使用距脸部空间的距离度量ε，图像被拒绝为不是脸部，被识别为一组熟悉的脸部之一，或者被确定为未知脸部。 在该系统中，识别速度高达每秒两次或三次。

## 5.Further Issues and Conclusion(进一步的问题和结论)

> 当前，我们正在通过为与特征视图相对应的每个已知人员定义少量的面部类别，来扩展该系统以处理各种方面（而不是正面视图）。 由于识别的速度，系统在几秒钟内有很多机会尝试识别许多略有不同的视图，其中至少有一个很可能接近特征视图之一。
>
> 智能系统还应具有随时间推移而适应的能力。 关于面部空间中图像的推理提供了一种以无人监督的方式学习和随后识别新面孔的方法。 当图像足够靠近脸部空间（即，像脸）但未分类为熟悉的脸部之一时，最初将其标记为“未知”。 计算机存储图案矢量和相应的未知图像。 如果“未知”模式向量的集合聚集在模式空间中，则假定存在一个新的但身份不明的面孔。
>
> 嘈杂的图像或部分被遮挡的脸部会导致识别性能下降，因为系统实质上为已知的脸部实现了自动关联存储（如[7]中所述）。 这可以通过图3（b）遮挡的面部图像的投影来证明。
>
> 信息理论推动了特征脸的人脸识别方法的产生，使人脸识别的思想基于一小套图像特征，这些特征最好地近似于已知的人脸图像集，而无需与我们对面部部位的直观概念相对应。 特征。 尽管这不是解决一般对象识别问题的理想解决方案，但特征脸方法确实提供了一种非常适合人脸识别问题的实用解决方案。 它运行速度快，相对简单，并且在有限的环境中已经证明可以正常工作。

